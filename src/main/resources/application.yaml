spring:
  application:
    name: gateway
  config:
    import: "optional:configserver:"
  
  # PostgreSQL 데이터베이스 설정 (Neon PostgreSQL)
  datasource:
    url: ${SPRING_DATASOURCE_URL:}
    username: ${SPRING_DATASOURCE_USERNAME:}
    password: ${SPRING_DATASOURCE_PASSWORD:}
    driver-class-name: ${SPRING_DATASOURCE_DRIVER_CLASS_NAME:org.postgresql.Driver}
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
      idle-timeout: 600000
      max-lifetime: 1800000
  
  # JPA 설정 (데이터소스가 있을 때만 활성화)
  jpa:
    hibernate:
      ddl-auto: ${SPRING_JPA_HIBERNATE_DDL_AUTO:none}
    show-sql: ${SPRING_JPA_SHOW_SQL:false}
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        format_sql: true
        use_sql_comments: true
    open-in-view: false
    database-platform: ${SPRING_JPA_DATABASE_PLATFORM:}
  
  # Redis 설정 (로컬 개발용 - 선택적, Redis가 없어도 애플리케이션은 시작됨)
  # OAuth Service와 공통 사용
  # Redis를 사용하려면 spring.data.redis.enabled=true로 설정하세요
  data:
    redis:
      enabled: ${REDIS_ENABLED:false}
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
      username: default
      password: ${REDIS_PASSWORD:}
      ssl:
        enabled: ${SPRING_REDIS_SSL_ENABLED:false}
      timeout: 2000ms
      lettuce:
        ssl:
          enabled: ${SPRING_REDIS_SSL_ENABLED:false}
          verify-peer: false
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
        shutdown-timeout: 100ms
  
  cloud:
    config:
      enabled: false
      import-check:
        enabled: false

springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /docs
    enabled: true
    operations-sorter: method
    tags-sorter: alpha
    use-root-path: false
    persist-authorization: true
    urls:
      - name: Gateway APIs
        url: /v3/api-docs
      - name: Transformer Service
        url: /koelectra/openapi.json
      - name: ML Service
        url: /api/mlservice/openapi.json
  show-actuator: false
  default-flat-param-object: true
  writer-with-order-by-keys: true

server:
  port: 8080

# ============================================================================
# OAuth Service 설정 (core.minsol.kr/oauthservice 통합)
# ============================================================================
kakao:
  rest-api-key: ${KAKAO_REST_API_KEY:}
  redirect-uri: ${KAKAO_REDIRECT_URI:}

google:
  client-id: ${GOOGLE_CLIENT_ID:}
  client-secret: ${GOOGLE_CLIENT_SECRET:}
  redirect-uri: ${GOOGLE_REDIRECT_URI:api.minsol.kr/google/callback}

naver:
  client-id: ${NAVER_CLIENT_ID:}
  client-secret: ${NAVER_CLIENT_SECRET:}
  redirect-uri: ${NAVER_REDIRECT_URI:}

# JWT 설정 (OAuth Service와 공통 사용)
jwt:
  secret: ${JWT_SECRET:}
  access-token-expiration: ${JWT_ACCESS_TOKEN_EXPIRATION:3600000} # 기본 1시간
  refresh-token-expiration: ${JWT_REFRESH_TOKEN_EXPIRATION:2592000000} # 기본 30일

# ============================================================================
# User Service 설정 (core.minsol.kr/adminservice 통합)
# ============================================================================
# User Service는 별도 포트(8082)에서 실행되며, Gateway를 통해 라우팅됩니다.
# 로컬 개발 시에는 별도로 실행해야 합니다.
